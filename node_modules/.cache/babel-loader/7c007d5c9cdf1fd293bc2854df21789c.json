{"ast":null,"code":"import _classCallCheck from \"/Users/yj/avo_market/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport auth0 from 'auth0-js';\nimport history from './history';\n\nvar Auth = function Auth() {\n  var _this = this;\n\n  _classCallCheck(this, Auth);\n\n  this.auth0 = new auth0.WebAuth({\n    domain: 'petieer.auth0.com',\n    clientID: 'blyOn45DgxXobYjsna02coskMXDXkL-t',\n    // redirectUri: process.env.NODE_ENV === 'development' ? 'http://localhost:3000/callback' : 'https://appbaseio-apps.github.io/petieer-auth0-example/callback',\n    redirectUri: 'http://localhost:3000/callback',\n    audience: 'https://petieer.auth0.com/userinfo',\n    responseType: 'token id_token',\n    scope: 'openid'\n  });\n\n  this.login = function () {\n    _this.auth0.authorize();\n  };\n\n  this.handleAuthentication = function () {\n    _this.auth0.parseHash(function (err, authResult) {\n      if (authResult && authResult.accessToken && authResult.idToken) {\n        _this.setSession(authResult);\n\n        history.replace('/home');\n      } else if (err) {\n        history.replace('/home');\n        console.log(err);\n      }\n    });\n  };\n\n  this.setSession = function (authResult) {\n    // Set the time that the access token will expire at\n    var expiresAt = JSON.stringify(authResult.expiresIn * 1000 + new Date().getTime());\n    localStorage.setItem('access_token', authResult.accessToken);\n    localStorage.setItem('id_token', authResult.idToken);\n    localStorage.setItem('expires_at', expiresAt); // navigate to the home route\n\n    history.replace('/home');\n  };\n\n  this.logout = function () {\n    // Clear access token and ID token from local storage\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('id_token');\n    localStorage.removeItem('expires_at'); // navigate to the home route\n\n    history.replace('/home');\n  };\n\n  this.isAuthenticated = function () {\n    // Check whether the current time is past the\n    // access token's expiry time\n    var expiresAt = JSON.parse(localStorage.getItem('expires_at'));\n    return new Date().getTime() < expiresAt;\n  };\n};\n\nexport { Auth as default };","map":{"version":3,"sources":["/Users/yj/avo_market/src/components/auth.js"],"names":["auth0","history","Auth","WebAuth","domain","clientID","redirectUri","audience","responseType","scope","login","authorize","handleAuthentication","parseHash","err","authResult","accessToken","idToken","setSession","replace","console","log","expiresAt","JSON","stringify","expiresIn","Date","getTime","localStorage","setItem","logout","removeItem","isAuthenticated","parse","getItem"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,UAAlB;AAEA,OAAOC,OAAP,MAAoB,WAApB;;IAEqBC,I;;;;;OAEnBF,K,GAAQ,IAAIA,KAAK,CAACG,OAAV,CAAkB;AACxBC,IAAAA,MAAM,EAAE,mBADgB;AAExBC,IAAAA,QAAQ,EAAE,kCAFc;AAGzB;AACAC,IAAAA,WAAW,EAAE,gCAJY;AAKzBC,IAAAA,QAAQ,EAAE,oCALe;AAMxBC,IAAAA,YAAY,EAAE,gBANU;AAOxBC,IAAAA,KAAK,EAAE;AAPiB,GAAlB,C;;OAURC,K,GAAQ,YAAM;AACZ,IAAA,KAAI,CAACV,KAAL,CAAWW,SAAX;AACD,G;;OAGDC,oB,GAAuB,YAAM;AAC3B,IAAA,KAAI,CAACZ,KAAL,CAAWa,SAAX,CAAqB,UAACC,GAAD,EAAMC,UAAN,EAAqB;AACxC,UAAIA,UAAU,IAAIA,UAAU,CAACC,WAAzB,IAAwCD,UAAU,CAACE,OAAvD,EAAgE;AAC9D,QAAA,KAAI,CAACC,UAAL,CAAgBH,UAAhB;;AACAd,QAAAA,OAAO,CAACkB,OAAR,CAAgB,OAAhB;AACD,OAHD,MAGO,IAAIL,GAAJ,EAAS;AACdb,QAAAA,OAAO,CAACkB,OAAR,CAAgB,OAAhB;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYP,GAAZ;AACD;AACF,KARD;AASD,G;;OAGDI,U,GAAa,UAACH,UAAD,EAAgB;AAC3B;AACA,QAAIO,SAAS,GAAGC,IAAI,CAACC,SAAL,CAAgBT,UAAU,CAACU,SAAX,GAAuB,IAAxB,GAAgC,IAAIC,IAAJ,GAAWC,OAAX,EAA/C,CAAhB;AACAC,IAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCd,UAAU,CAACC,WAAhD;AACAY,IAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCd,UAAU,CAACE,OAA5C;AACAW,IAAAA,YAAY,CAACC,OAAb,CAAqB,YAArB,EAAmCP,SAAnC,EAL2B,CAM3B;;AACArB,IAAAA,OAAO,CAACkB,OAAR,CAAgB,OAAhB;AACD,G;;OAGDW,M,GAAS,YAAM;AACb;AACAF,IAAAA,YAAY,CAACG,UAAb,CAAwB,cAAxB;AACAH,IAAAA,YAAY,CAACG,UAAb,CAAwB,UAAxB;AACAH,IAAAA,YAAY,CAACG,UAAb,CAAwB,YAAxB,EAJa,CAKb;;AACA9B,IAAAA,OAAO,CAACkB,OAAR,CAAgB,OAAhB;AACD,G;;OAGDa,e,GAAkB,YAAM;AACtB;AACA;AACA,QAAIV,SAAS,GAAGC,IAAI,CAACU,KAAL,CAAWL,YAAY,CAACM,OAAb,CAAqB,YAArB,CAAX,CAAhB;AACA,WAAO,IAAIR,IAAJ,GAAWC,OAAX,KAAuBL,SAA9B;AACD,G;;;SAxDkBpB,I","sourcesContent":["import auth0 from 'auth0-js';\n\nimport history from './history';\n\nexport default class Auth {\n  // Please use your own credentials here\n  auth0 = new auth0.WebAuth({\n    domain: 'petieer.auth0.com',\n    clientID: 'blyOn45DgxXobYjsna02coskMXDXkL-t',\n   // redirectUri: process.env.NODE_ENV === 'development' ? 'http://localhost:3000/callback' : 'https://appbaseio-apps.github.io/petieer-auth0-example/callback',\n   redirectUri: 'http://localhost:3000/callback',\n   audience: 'https://petieer.auth0.com/userinfo',\n    responseType: 'token id_token',\n    scope: 'openid'\n  });\n\n  login = () => {\n    this.auth0.authorize();\n  }\n\n  // parses the result after authentication from URL hash\n  handleAuthentication = () => {\n    this.auth0.parseHash((err, authResult) => {\n      if (authResult && authResult.accessToken && authResult.idToken) {\n        this.setSession(authResult);\n        history.replace('/home');\n      } else if (err) {\n        history.replace('/home');\n        console.log(err);\n      }\n    });\n  }\n\n  // Sets user details in localStorage\n  setSession = (authResult) => {\n    // Set the time that the access token will expire at\n    let expiresAt = JSON.stringify((authResult.expiresIn * 1000) + new Date().getTime());\n    localStorage.setItem('access_token', authResult.accessToken);\n    localStorage.setItem('id_token', authResult.idToken);\n    localStorage.setItem('expires_at', expiresAt);\n    // navigate to the home route\n    history.replace('/home');\n  }\n\n  // removes user details from localStorage\n  logout = () => {\n    // Clear access token and ID token from local storage\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('id_token');\n    localStorage.removeItem('expires_at');\n    // navigate to the home route\n    history.replace('/home');\n  }\n\n  // checks if the user is authenticated\n  isAuthenticated = () => {\n    // Check whether the current time is past the\n    // access token's expiry time\n    let expiresAt = JSON.parse(localStorage.getItem('expires_at'));\n    return new Date().getTime() < expiresAt;\n  }\n}"]},"metadata":{},"sourceType":"module"}